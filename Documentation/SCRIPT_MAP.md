# –ö–∞—Ä—Ç–∞ —Å–∫—Ä–∏–ø—Ç–∞ SplitText.jsx

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∞—Ä—Ç—É –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UI (—Å—Ç—Ä–æ–∫–∏ 1-97)
- **–°–æ–∑–¥–∞–Ω–∏–µ –æ–∫–Ω–∞**: `win` - –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ –ø–∞–ª–∏—Ç—Ä—ã
- **–ü–∞–Ω–µ–ª—å Actions** (—Å—Ç—Ä–æ–∫–∏ 9-27): –∫–Ω–æ–ø–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
  - `btnSplit` - "Split into Layers"
  - `btnSplitInLayer` - "Split into Lines"
- **–ü–∞–Ω–µ–ª—å Options** (—Å—Ç—Ä–æ–∫–∏ 29-56): –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
  - `splitByLinesCheckbox` - "Split into Layers by Lines" (v1.2)
  - `splitByMidCheckbox` - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–µ—Ä–µ–¥–∏–Ω–µ —Å–ª–æ—è
  - `useSplitSymbolCheckbox` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
  - `splitSymbolInput` - –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å–∏–º–≤–æ–ª–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–ü–∞–Ω–µ–ª—å Rename** (—Å—Ç—Ä–æ–∫–∏ 58-81): –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ –Ω—É–º–µ—Ä–∞—Ü–∏—è
  - `nameMaskInput` - –ø–æ–ª–µ –≤–≤–æ–¥–∞ –º–∞—Å–∫–∏ –∏–º–µ–Ω–∏
  - `btnRename` - –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
  - `upCheckbox` - —á–µ–∫–±–æ–∫—Å "Up" –¥–ª—è –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏ (v1.2)
- **–°—Ç–∞—Ç—É—Å-–±–∞—Ä** (—Å—Ç—Ä–æ–∫–∏ 83-85): –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- **–ü–æ–¥–≤–∞–ª** (—Å—Ç—Ä–æ–∫–∏ 93-96): –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### 2. –ú–∞—Å—Å–∏–≤—ã –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 91-243)
- **avoidEndWords** (—Å—Ç—Ä–æ–∫–∏ 92-121): —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏
  - **–¢–û–õ–¨–ö–û**: –ø—Ä–µ–¥–ª–æ–≥–∏, –∞—Ä—Ç–∏–∫–ª–∏, —Å–æ—é–∑—ã, –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è (—Ä—É—Å—Å–∫–∏–µ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ)
  - **–ù–ï –°–û–î–ï–†–ñ–ò–¢**: –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã, –Ω–∞—Ä–µ—á–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞ (—É–±—Ä–∞–Ω—ã –≤ v1.2)
- **neverSplitWords** (—Å—Ç—Ä–æ–∫–∏ 124-137): —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è
  - –ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã (—Ä—É—Å—Å–∫–∏–µ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ)
  - –ï–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
- **compoundExpressions** (—Å—Ç—Ä–æ–∫–∏ 140-237): —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
  - **–¢–û–õ–¨–ö–û**: –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–≥–∏, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –∫–æ–º–ø–∞–Ω–∏–∏
  - **–ù–ï –°–û–î–ï–†–ñ–ò–¢**: –ø–∞—Ä—ã "subject+verb" —Ç–∏–ø–∞ "i have", "we will" (—É–±—Ä–∞–Ω—ã –≤ v1.2)
  - –§—Ä–∞–∑–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (—Ä—É—Å—Å–∫–∏–µ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ)
  - –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è (–≥–æ—Ä–æ–¥–∞, —Ä–µ–≥–∏–æ–Ω—ã, —à—Ç–∞—Ç—ã)
  - –ö–æ–º–ø–∞–Ω–∏–∏ –∏ –±—Ä–µ–Ω–¥—ã
- **openingChars** (—Å—Ç—Ä–æ–∫–∞ 240): –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ —Å–∏–º–≤–æ–ª—ã `"`, `'`, `(`, `[`, `{`, `¬´`
- **specialChars** (—Å—Ç—Ä–æ–∫–∞ 243): —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã `,`, `.`, `!`, `?`, `:`, `;`

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞
- **validateSelection()** (—Å—Ç—Ä–æ–∫–∏ 260-295)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–±–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ comp, layers: [{layer, text}, ...] }` –∏–ª–∏ `null`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: Split into Layers, Split into Lines

- **validateSelectionForRename()** (—Å—Ç—Ä–æ–∫–∏ 1072-1117)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–±–æ—Ä –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–ª–æ–µ–≤
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ-—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–ª–æ–µ–≤
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ comp, layers: [layer, ...] }` –∏–ª–∏ `null`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è: Rename & Number Layers

### –ü–æ–∏—Å–∫ –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **findLineBreak(text)** (—Å—Ç—Ä–æ–∫–∏ 300-312)
  - –ò—â–µ—Ç –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ (\r\n, \r, \n) —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º: \r\n > \r > \n
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ position, length }` –∏–ª–∏ `null`

- **calculateSplitPosition(text, checkLineBreak)** (—Å—Ç—Ä–æ–∫–∏ 317-347)
  - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–∑–∏—Ü–∏—é —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: 1) –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫ (–µ—Å–ª–∏ `checkLineBreak=true`), 2) —Å–∏–º–≤–æ–ª —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è, 3) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ position, length }` –∏–ª–∏ `null`

- **findSplitPosition(text, middleIndex)** (—Å—Ç—Ä–æ–∫–∏ 667-688)
  - –ù–∞—Ö–æ–¥–∏—Ç –±–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ–±–µ–ª –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ç–µ–∫—Å—Ç–∞ (`middleIndex`)
  - –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ `applyAdvancedFormattingRules()`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –∏–Ω–¥–µ–∫—Å –ø—Ä–æ–±–µ–ª–∞ –∏–ª–∏ -1

- **calculateSplitPositionForLine(line)** (—Å—Ç—Ä–æ–∫–∏ 616-636)
  - –†–∞—Å—á–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–±–µ–∑ —É—á–µ—Ç–∞ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫)
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{ position, length }` –∏–ª–∏ `null`

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **handleSplit(createNewLayers)** (—Å—Ç—Ä–æ–∫–∏ 352-430)
  - –ì–ª–∞–≤–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
  - `createNewLayers = true` ‚Üí Split into Layers
  - `createNewLayers = false` ‚Üí Split into Lines
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä —Å–ª–æ–µ–≤
  - –î–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –≤ "Split into Layers" –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä–µ–¥–∏–Ω—É –≤—Ä–µ–º–µ–Ω–∏ —Å–ª–æ—è
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ–∂–∏–º "Split into Layers by Lines" (v1.2)

- **createLayersFromLines(comp, layer, lines)** (—Å—Ç—Ä–æ–∫–∏ 435-475) - v1.2
  - –°–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–ª–æ–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ —Ç–µ–∫—Å—Ç–∞
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º —á–µ–∫–±–æ–∫—Å–µ "Split into Layers by Lines"
  - –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Ä–µ–º—è —Å–ª–æ—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ –º–µ–∂–¥—É —Å—Ç—Ä–æ–∫–∞–º–∏
  - –ö–æ–ø–∏—Ä—É–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è —á–µ—Ä–µ–∑ `copyLayerProperties()`
  - –£–¥–∞–ª—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ª–æ–π

- **createSplitLayers(comp, layer, text, splitInfo)** (—Å—Ç—Ä–æ–∫–∏ 480-515)
  - –°–æ–∑–¥–∞–µ—Ç –¥–≤–∞ –Ω–æ–≤—ã—Ö —Å–ª–æ—è –∏–∑ –æ–¥–Ω–æ–≥–æ
  - –ö–æ–ø–∏—Ä—É–µ—Ç —Å–≤–æ–π—Å—Ç–≤–∞ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è —á–µ—Ä–µ–∑ `copyLayerProperties()`
  - –£–¥–∞–ª—è–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ª–æ–π
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `setCursorToMid()` –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω —á–µ–∫–±–æ–∫—Å "Split at Layer Middle"

- **updateLayerText(layer, text, splitInfo)** (—Å—Ç—Ä–æ–∫–∏ 520-577)
  - –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Å–ª–æ–µ
  - –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ (–µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å –ø–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫)
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `splitTextIntoLines()` –∏ `calculateSplitPositionForLine()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
  - –ï—Å–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `splitInfo` –Ω–∞–ø—Ä—è–º—É—é

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ–∫—Å—Ç–∞
- **splitTextIntoLines(text)** (—Å—Ç—Ä–æ–∫–∏ 583-613)
  - –†–∞–∑–¥–µ–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏ —Å —É—á–µ—Ç–æ–º —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ (\r\n, \r, \n)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –º–∞—Å—Å–∏–≤ —Å—Ç—Ä–æ–∫
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `indexOf()`

- **copyLayerProperties(source, target)** (—Å—Ç—Ä–æ–∫–∏ 641-662)
  - –ö–æ–ø–∏—Ä—É–µ—Ç transform —Å–≤–æ–π—Å—Ç–≤–∞ –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
  - –ü–æ–∑–∏—Ü–∏—è, –º–∞—Å—à—Ç–∞–±, –ø–æ–≤–æ—Ä–æ—Ç, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `try-catch` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

### –ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **applyAdvancedFormattingRules(text, splitIndex)** (—Å—Ç—Ä–æ–∫–∏ 693-748)
  - –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª
  - –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ (–ü–†–ò–û–†–ò–¢–ï–¢–´):
    1. `isCompoundExpression()` - —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (–º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–≥–∏, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –∫–æ–º–ø–∞–Ω–∏–∏)
    2. `avoidEndWords` - —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–æ–∫–∏ (–ø—Ä–µ–¥–ª–æ–≥–∏, –∞—Ä—Ç–∏–∫–ª–∏, —Å–æ—é–∑—ã, –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è)
    3. `shouldNeverSplit()` - —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è (–∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã, –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è)
    4. `isSpecialTerm()` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã (–≥–æ—Ä–æ–¥–∞, –±—Ä–µ–Ω–¥—ã) - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `compoundExpressions`, –∏—Å–∫–ª—é—á–∞—è —Ñ—Ä–∞–∑—ã
    5. `applyBasicFormattingRules()` - –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ (–æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ —Å–∏–º–≤–æ–ª—ã, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)

- **applyBasicFormattingRules(text, splitIndex, beforeSplit, afterSplit)** (—Å—Ç—Ä–æ–∫–∏ 751-795)
  - –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ `avoidEndWords`, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —É–∂–µ –≤ `applyAdvancedFormattingRules`)
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `openingChars`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `specialChars`

- **applyFormattingRules(text, splitIndex)** (—Å—Ç—Ä–æ–∫–∏ 987-1048) - ‚ö†Ô∏è **–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø**
  - –°—Ç–∞—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  - –î—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å `applyAdvancedFormattingRules` –∏ `applyBasicFormattingRules`
  - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–¥–∞–ª–∏—Ç—å –≤ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö

### –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–∞–≤–∏–ª
- **shouldNeverSplit(beforeSplit, afterSplit)** (—Å—Ç—Ä–æ–∫–∏ 811-831)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç `neverSplitWords` (O(1) –ø–æ–∏—Å–∫ —á–µ—Ä–µ–∑ –æ–±—ä–µ–∫—Ç)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä—ã —Å —á–∏—Å–ª–∞–º–∏ —á–µ—Ä–µ–∑ `isAbbreviationWithNumber()`
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `true` –µ—Å–ª–∏ —Å–ª–æ–≤–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã —Ä–∞–∑–¥–µ–ª—è—Ç—å—Å—è

- **isSpecialTerm(beforeSplit, afterSplit)** (—Å—Ç—Ä–æ–∫–∏ 834-888)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –∫–æ–º–ø–∞–Ω–∏–∏
  - –ò—â–µ—Ç –≤ `compoundExpressions`, –Ω–æ –∏—Å–∫–ª—é—á–∞–µ—Ç —Ñ—Ä–∞–∑–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–ø–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ—Ç 1 –¥–æ 3 —Å–ª–æ–≤
  - ‚ö†Ô∏è **–î–£–ë–õ–ò–†–£–ï–¢ –õ–û–ì–ò–ö–£** —Å `isCompoundExpression` - –æ–±–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç `compoundExpressions`

- **isCompoundExpression(beforeSplit, afterSplit)** (—Å—Ç—Ä–æ–∫–∏ 891-926)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è (–º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–≥–∏, –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –∫–æ–º–ø–∞–Ω–∏–∏)
  - –ò—â–µ—Ç –≤ `compoundExpressions` (O(1) –ø–æ–∏—Å–∫)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –æ—Ç 1 –¥–æ 3 —Å–ª–æ–≤ —Å –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `true` –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —Å–æ—Å—Ç–∞–≤–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ

- **isAbbreviationWithNumber(lastWord, firstWord)** (—Å—Ç—Ä–æ–∫–∏ 802-808)
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä —Å —á–∏—Å–ª–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—Ä–∏—Å. 1")
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü–æ–∏—Å–∫ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- **findAlternativePosition(text, splitIndex)** (—Å—Ç—Ä–æ–∫–∏ 929-944)
  - –ò—â–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –ø–æ–∑–∏—Ü–∏—é —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
  - –°–Ω–∞—á–∞–ª–∞ –∏—â–µ—Ç –ø—Ä–æ–±–µ–ª —Ä–∞–Ω—å—à–µ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏, –ø–æ—Ç–æ–º –ø–æ–∑–∂–µ
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π `splitIndex`, –µ—Å–ª–∏ –ø—Ä–æ–±–µ–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

- **findCompoundSafePosition(text, splitIndex)** (—Å—Ç—Ä–æ–∫–∏ 947-982)
  - –ò—â–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π
  - –î–ª—è –¥–≤—É—Ö—Å–ª–æ–≤–Ω—ã—Ö: –∏—â–µ—Ç –ø–æ–∑–∏—Ü–∏—é –º–µ–∂–¥—É —Å–ª–æ–≤–∞–º–∏ (–ø–µ—Ä–µ–¥ –≤—Ç–æ—Ä—ã–º —Å–ª–æ–≤–æ–º)
  - –î–ª—è —Ç—Ä–µ—Ö—Å–ª–æ–≤–Ω—ã—Ö: –∏—â–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø–æ—Å–ª–µ –≤—Ç–æ—Ä–æ–≥–æ —Å–ª–æ–≤–∞
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `afterText.indexOf()` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ v1.2)
  - –ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç, –≤—ã–∑—ã–≤–∞–µ—Ç `findAlternativePosition()`

### –£—Ç–∏–ª–∏—Ç—ã
- **setCursorToMid(comp, layer)** (—Å—Ç—Ä–æ–∫–∏ 1053-1067)
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫—É—Ä—Å–æ—Ä –≤ —Å–µ—Ä–µ–¥–∏–Ω—É —Å–ª–æ—è
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ (`outPoint > inPoint`)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –≤—Ä–µ–º—è —Å–µ—Ä–µ–¥–∏–Ω—ã –∏–ª–∏ `null` –ø—Ä–∏ –æ—à–∏–±–∫–µ

- **renameAndNumberLayers()** (—Å—Ç—Ä–æ–∫–∏ 1122-1317)
  - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –∏ –Ω—É–º–µ—Ä—É–µ—Ç —Å–ª–æ–∏
  - –°–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ `inPoint` (–ø—É–∑—ã—Ä—å–∫–æ–≤–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞)
  - –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç —Å–ª–æ–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ (–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º)
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞—Å–∫–∏ –∏–º–µ–Ω —Å `{num}` –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–º
  - 4-–∑–Ω–∞—á–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è (0001, 0002, ...)
  - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —á–µ–∫–±–æ–∫—Å "Up" –¥–ª—è –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–∏ (v1.2)

## üéØ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π (—Å—Ç—Ä–æ–∫–∏ 1322-1335)
- `btnSplit.onClick` ‚Üí `handleSplit(true)`
- `btnSplitInLayer.onClick` ‚Üí `handleSplit(false)`
- `btnRename.onClick` ‚Üí `renameAndNumberLayers()`
- `win.onShow` ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–ª–æ–µ–≤

## üìç –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
- **–°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–µ–≤ –∏–∑ —Å—Ç—Ä–æ–∫**: `createLayersFromLines()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 435 (v1.2)
- **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–ª–æ–µ–≤**: `createSplitLayers()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 480
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —Å–ª–æ–µ**: `updateLayerText()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 520
- **–ì–ª–∞–≤–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫**: `handleSplit()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 352

### –ü—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∞–≤–∏–ª**: `applyAdvancedFormattingRules()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 693
- **–ë–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞**: `applyBasicFormattingRules()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 751
- **–°—Ç–∞—Ä–∞—è —Ñ—É–Ω–∫—Ü–∏—è (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)**: `applyFormattingRules()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 987
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤**: `isSpecialTerm()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 834
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π**: `isCompoundExpression()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 891

### –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- **–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è**: `renameAndNumberLayers()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 1122
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: `validateSelectionForRename()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 1072

### –ü–æ–∏—Å–∫ –ø–æ–∑–∏—Ü–∏–π
- **–ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫**: `findLineBreak()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 300
- **–ü–æ–∑–∏—Ü–∏—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è**: `calculateSplitPosition()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 317
- **–ë–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ–±–µ–ª**: `findSplitPosition()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 667
- **–ü–æ–∑–∏—Ü–∏—è –¥–ª—è —Å—Ç—Ä–æ–∫–∏**: `calculateSplitPositionForLine()` ‚Üí —Å—Ç—Ä–æ–∫–∞ 616

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç ExtendScript-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `let/const`, —Å—Ç—Ä–µ–ª–æ—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, `slice()`, `map()`, `filter()`, `find()`, `forEach()`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `var`, `indexOf()`, `lastIndexOf()`, `substring()`, —Ä—É—á–Ω—ã–µ —Ü–∏–∫–ª—ã –¥–ª—è –º–∞—Å—Å–∏–≤–æ–≤
- –í—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤ `compoundExpressions` —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- –ú–∞—Å—Å–∏–≤—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ –æ–±—ä–µ–∫—Ç—ã –¥–ª—è O(1) –ø–æ–∏—Å–∫–∞ (`avoidEndWords`, `neverSplitWords`, `compoundExpressions`)

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –§—É–Ω–∫—Ü–∏—è `applyFormattingRules()` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–º–µ—Ä—Ç–≤—ã–π –∫–æ–¥)
- `isSpecialTerm()` –∏ `isCompoundExpression()` –¥—É–±–ª–∏—Ä—É—é—Ç –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ `compoundExpressions`
- –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞—É–¥–∏—Ç –∫–æ–¥–∞: —Å–º. [CODE_AUDIT.md](CODE_AUDIT.md)
